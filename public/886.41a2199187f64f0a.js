"use strict";(self.webpackChunkChatAppClient=self.webpackChunkChatAppClient||[]).push([[886],{886:(x,g,l)=>{l.r(g),l.d(g,{AuthModule:()=>S});var d=l(6895),o=l(433),c=l(5649),h=l(5226),p=l.n(h),e=l(8256),f=l(6518);function Z(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Log In"),e.qZA())}function b(t,a){1&t&&e._UZ(0,"span",18)}let y=(()=>{class t{constructor(r,n,i){this.fb=r,this.authService=n,this.router=i,this.form=this.fb.group({username:["",[o.kI.required,o.kI.minLength(3)]],password:["",[o.kI.required,o.kI.minLength(6),o.kI.maxLength(12)]]}),this.busy=!1}login(){if(this.form.invalid)return void this.form.markAllAsTouched();this.busy=!0;const{username:r,password:n}=this.form.value;this.authService.login(r,n).subscribe({next:i=>{this.busy=!1,i.ok?this.router.navigateByUrl("/home"):p().fire("Error","Error","error")},error:i=>{this.busy=!1,400===i.status||401===i.status?p().fire("Error","Username or password invalid","error"):p().fire("Error","Error","error")}})}togglePasswordVisibility(r){r.setAttribute("type","password"===r.type?"text":"password")}isFieldValid(r){const n=this.form.get(r);return n&&n?.touched&&n.errors}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(o.qu),e.Y36(f.e),e.Y36(c.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login-page"]],decls:36,vars:9,consts:[[3,"formGroup","ngSubmit"],[1,"text-center"],[1,"mb-4"],[1,"mb-1"],["for","username",1,"form-label"],[1,"position-relative"],["formControlName","username","autofocus","","id","username","type","text","placeholder","CoolName",1,"form-control","icon-container-left"],[1,"material-icons","icon-left"],[1,"form-text","text-danger"],[1,"mb-3"],["for","password",1,"form-label"],["formControlName","password","id","password","type","password","placeholder","Password",1,"form-control","icon-container-left","icon-container-right"],["pass",""],[1,"material-icons","icon-right","cursor-pointer",3,"click"],["type","submit",1,"btn","btn-primary","w-100","fw-semibold",3,"disabled"],[4,"ngIf","ngIfElse"],["spinner",""],["routerLink","/auth/register",1,"link-primary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,n){if(1&r){const i=e.EpF();e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.login()}),e.TgZ(1,"h2",1),e._uU(2,"Log in to your account"),e.qZA(),e._UZ(3,"hr",2),e.TgZ(4,"section",3)(5,"label",4),e._uU(6,"Username"),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"input",6),e.TgZ(9,"span",7),e._uU(10,"person"),e.qZA()(),e.TgZ(11,"span",8),e._uU(12," The username must be 3 or more letters, numbers or _ "),e.qZA()(),e.TgZ(13,"section",9)(14,"label",10),e._uU(15,"Password"),e.qZA(),e.TgZ(16,"div",5),e._UZ(17,"input",11,12),e.TgZ(19,"span",7),e._uU(20,"lock"),e.qZA(),e.TgZ(21,"span",13),e.NdJ("click",function(){e.CHM(i);const u=e.MAs(18);return e.KtG(n.togglePasswordVisibility(u))}),e._uU(22),e.qZA()(),e.TgZ(23,"span",8),e._uU(24," The username must be 6 to 12 characters "),e.qZA()(),e.TgZ(25,"section",2)(26,"button",14),e.YNc(27,Z,2,0,"span",15),e.YNc(28,b,1,0,"ng-template",null,16,e.W1O),e.qZA()(),e.TgZ(30,"section",1)(31,"span"),e._uU(32,"Don't have an account?"),e.qZA(),e._UZ(33,"br"),e.TgZ(34,"a",17),e._uU(35," Sign up "),e.qZA()()()}if(2&r){const i=e.MAs(18),s=e.MAs(29);e.Q6J("formGroup",n.form),e.xp6(11),e.ekj("hidden",!n.isFieldValid("username")),e.xp6(11),e.hij(" ","password"===i.type?"visibility":"visibility_off"," "),e.xp6(1),e.ekj("hidden",!n.isFieldValid("password")),e.xp6(3),e.Q6J("disabled",n.busy),e.xp6(1),e.Q6J("ngIf",!n.busy)("ngIfElse",s)}},dependencies:[d.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,c.yS]}),t})(),v=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-page"]],decls:5,vars:0,consts:[[1,"container-fluid","vh-100","bg"],[1,"row","h-100","align-items-center"],[1,"col"],[1,"card","panel","px-4","py-5","shadow","mx-auto"]],template:function(r,n){1&r&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"section",3),e._UZ(4,"router-outlet"),e.qZA()()()())},dependencies:[c.lC],styles:["a[_ngcontent-%COMP%]:hover{cursor:pointer}.panel[_ngcontent-%COMP%]{max-width:500px}.bg[_ngcontent-%COMP%]{background:#1b66ac;background:radial-gradient(circle,#9b66da 0%,#8564d8 28%,#7123e7 65%,#1b66ac 100%)}"]}),t})(),w=(()=>{class t{constructor(){}fieldsEqual(r,n){return i=>{const s=i.get(n),u=i.get(r)?.value,m=s?.value;return u!==m?(s?.setErrors({...s?.errors,differentValues:!0}),{differentValues:!0}):(s?.errors&&s?.errors.differentValues&&(delete s.errors.differentValues,0===Object.entries(s.errors).length&&s.setErrors(null)),null)}}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var A=l(9751),T=l(1566),_=l(3532);var P=l(3900),k=l(4004);let I=(()=>{class t{constructor(r){this.authService=r}validate(r){const n=r.value;return function C(t=0,a,r=T.P){let n=-1;return null!=a&&((0,_.K)(a)?r=a:n=a),new A.y(i=>{let s=function U(t){return t instanceof Date&&!isNaN(t)}(t)?+t-r.now():t;s<0&&(s=0);let u=0;return r.schedule(function(){i.closed||(i.next(u++),0<=n?this.schedule(void 0,n):i.complete())},s)})}(300).pipe((0,P.w)(()=>this.authService.isUsernameValid(n).pipe((0,k.U)(i=>i?null:{usernameTaken:!0}))))}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(f.e))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function M(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Create account"),e.qZA())}function V(t,a){1&t&&e._UZ(0,"span",21)}const q=[{path:"",component:v,children:[{path:"login",component:y},{path:"register",component:(()=>{class t{constructor(r,n,i,s,u){this.fb=r,this.authService=n,this.router=i,this.validatorService=s,this.usernameValidator=u,this.form=this.fb.group({username:["",[o.kI.required,o.kI.minLength(3),o.kI.pattern(/^[\w]*$/)],[this.usernameValidator]],password:["",[o.kI.required,o.kI.minLength(6),o.kI.maxLength(12),o.kI.pattern(/^[-@.!\/#&+\w\s]*$/)]],confirm_password:["",[o.kI.required,o.kI.minLength(6),o.kI.pattern(/^[-@.!\/#&+\w\s]*$/)]]},{validators:[this.validatorService.fieldsEqual("password","confirm_password")]}),this.busy=!1}signup(){if(this.form.invalid)return void this.form.markAllAsTouched();this.busy=!0;const{username:r,password:n,confirm_password:i}=this.form.value;this.authService.signup(r,n,i).subscribe({next:s=>{this.busy=!1,s.ok?this.router.navigateByUrl("/home"):p().fire("Error",s.msg,"error")},error:s=>{this.busy=!1,400===s.status||401===s.status?p().fire("Error","Username or password invalid","error"):p().fire("Error",s.error.msg,"error")}})}togglePasswordVisibility(r){r.setAttribute("type","password"===r.type?"text":"password")}isFieldValid(r){const n=this.form.get(r);return n&&n?.touched&&n.errors}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(o.qu),e.Y36(f.e),e.Y36(c.F0),e.Y36(w),e.Y36(I))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-register-page"]],decls:48,vars:13,consts:[[3,"formGroup","ngSubmit"],[1,"text-center"],[1,"mb-4"],[1,"mb-1"],["for","username",1,"form-label"],[1,"position-relative"],["formControlName","username","autofocus","","autocomplete","off","id","username","type","text","placeholder","CoolName",1,"form-control","icon-container-left"],[1,"material-icons","icon-left"],[1,"form-text","text-danger"],["for","password",1,"form-label"],["formControlName","password","id","password","type","password","placeholder","Password",1,"form-control","icon-container-left","icon-container-right"],["pass",""],[1,"material-icons","icon-right","cursor-pointer",3,"click"],[1,"mb-3"],["for","confirm-password",1,"form-label"],["formControlName","confirm_password","id","confirm-password","type","password","placeholder","Password",1,"form-control","icon-container-left","icon-container-right"],["pass_confirmation",""],["type","submit",1,"btn","btn-primary","w-100","fw-semibold",3,"disabled"],[4,"ngIf","ngIfElse"],["spinner",""],["routerLink","/auth/login",1,"link-primary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,n){if(1&r){const i=e.EpF();e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.signup()}),e.TgZ(1,"h2",1),e._uU(2,"Create a new account"),e.qZA(),e._UZ(3,"hr",2),e.TgZ(4,"section",3)(5,"label",4),e._uU(6,"Username"),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"input",6),e.TgZ(9,"span",7),e._uU(10,"person"),e.qZA()(),e.TgZ(11,"span",8),e._uU(12),e.qZA()(),e.TgZ(13,"section",3)(14,"label",9),e._uU(15,"Password"),e.qZA(),e.TgZ(16,"div",5),e._UZ(17,"input",10,11),e.TgZ(19,"span",7),e._uU(20,"lock"),e.qZA(),e.TgZ(21,"span",12),e.NdJ("click",function(){e.CHM(i);const u=e.MAs(18);return e.KtG(n.togglePasswordVisibility(u))}),e._uU(22),e.qZA()(),e.TgZ(23,"span",8),e._uU(24," The password must be 6 to 12 characters "),e.qZA()(),e.TgZ(25,"section",13)(26,"label",14),e._uU(27,"Confirm Password"),e.qZA(),e.TgZ(28,"div",5),e._UZ(29,"input",15,16),e.TgZ(31,"span",7),e._uU(32,"lock"),e.qZA(),e.TgZ(33,"span",12),e.NdJ("click",function(){e.CHM(i);const u=e.MAs(30);return e.KtG(n.togglePasswordVisibility(u))}),e._uU(34),e.qZA()(),e.TgZ(35,"span",8),e._uU(36," Passwords must match "),e.qZA()(),e.TgZ(37,"section",2)(38,"button",17),e.YNc(39,M,2,0,"span",18),e.YNc(40,V,1,0,"ng-template",null,19,e.W1O),e.qZA()(),e.TgZ(42,"section",1)(43,"span"),e._uU(44,"Already have an account?"),e.qZA(),e._UZ(45,"br"),e.TgZ(46,"a",20),e._uU(47," Log In "),e.qZA()()()}if(2&r){const i=e.MAs(18),s=e.MAs(30),u=e.MAs(41);let m;e.Q6J("formGroup",n.form),e.xp6(11),e.ekj("hidden",!n.isFieldValid("username")),e.xp6(1),e.hij(" ",null!=(m=n.form.get("username"))&&null!=m.errors&&m.errors.hasOwnProperty("usernameTaken")?"The username is already taken":"The username must have 3 or more letters, numbers or _"," "),e.xp6(10),e.hij(" ","password"===i.type?"visibility":"visibility_off"," "),e.xp6(1),e.ekj("hidden",!n.isFieldValid("password")),e.xp6(11),e.hij(" ","password"===s.type?"visibility":"visibility_off"," "),e.xp6(1),e.ekj("hidden",!n.isFieldValid("confirm_password")),e.xp6(3),e.Q6J("disabled",n.busy),e.xp6(1),e.Q6J("ngIf",!n.busy)("ngIfElse",u)}},dependencies:[d.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,c.yS]}),t})()},{path:"**",redirectTo:"login"}]}];let L=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.Bz.forChild(q),c.Bz]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,o.UX,L]}),t})()}}]);